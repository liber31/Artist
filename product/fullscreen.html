<!DOCTYPE html>
<html>
    <head>
        <title>Game</title>
        <meta charset="UTF-8" />
        <link rel="stylesheet" type="text/css" href="https://naptok.github.io/Artist/product/main.css" />
        <script type="text/javascript" src="https://naptok.github.io/Artist/product/artist.js"></script>
    </head>

    <script>
        room['game'] = function() {
            set_fullscreen();
            DEBUG = true;
            for (let index = 0; index < 10; index++) {
                sprite_load(`https://naptok.github.io/Artist/product//img/char_snow_run_${index}.png`, `char_snow_run_${index}`);
            }
            sprite_load(`https://naptok.github.io/Artist/product//img/farback.png`, `farback`);
            sprite_load(`https://naptok.github.io/Artist/product//img/sky.png`, `sky`);
            sprite_load(`https://naptok.github.io/Artist/product//img/snow_floor.png`, `snow_floor`);

            class background extends instance {
                constructor() {
                    super();
                }

                create() {
                    this.snow_floor = 0;
                    this.farback = 0;
                }

                step() {
                    this.x -= 3;
                    this.farback -= 5;
                    this.snow_floor -= 7;
                    if (this.x <= -sprite_get_width('sky') * 2) {
                        this.x = 0;
                    }
                    if (this.snow_floor <= -sprite_get_width('sky') * 2) {
                        this.snow_floor = 0;
                    }
                    if (this.farback <= -sprite_get_width('farback') * 2) {
                        this.farback = 0;
                    }
                }

                draw() {
                    draw_sprite_ext(this.x, this.y, `sky`, 'left', 2, 2);
                    draw_sprite_ext(this.x + sprite_get_width('sky') * 2, this.y, `sky`, 'left', 2, 2);
                    draw_sprite_ext(this.farback, this.y - 50, `farback`, 'left', 2, 2);
                    draw_sprite_ext(this.farback + sprite_get_width('farback') * 2, this.y - 50, `farback`, 'left', 2, 2);
                    for (let index = 0; index < 30; index++) {
                        draw_sprite_ext(this.snow_floor + sprite_get_width('snow_floor') * index, this.y + 354, `snow_floor`, 'left', 3, 3);
                    }
                }
            }
            class character extends instance {
                constructor() {
                    super();
                }

                create() {
                    this.image_index = 0;
                }

                step() {
                    this.image_index += 0.3;
                    if (this.image_index >= 10) {
                        this.image_index = 0;
                    }
                }

                draw() {
                    draw_sprite_ext(this.x, this.y, `char_snow_run_${Math.floor(this.image_index)}`, 'center', 2, 2);
                }
            }
            instance_create(character, 80, height - 150, 2);
            instance_create(background, 0, 0, 1);
        };

        room_goto('game');
    </script>

    <body>
        <canvas id="canvas" width="1000" height="450"> </canvas>
    </body>
</html>
