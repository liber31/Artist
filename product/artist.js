function setTargetSize(e,i){window.variables.WIDTH=e,window.variables.HEIGHT=i,window.variables.TARGET_CANVAS.width=window.variables.WIDTH,window.variables.TARGET_CANVAS.height=window.variables.HEIGHT}function setCanvas(e){window.variables.CANVAS=e}function setFps(e){window.variables.FPS_INTERVAL=1e3/e}async function render(){const e=window.variables.TARGET_CANVAS,i=e.getContext("2d");i.clearRect(0,0,e.width,e.height),i.rect(0,0,e.width,e.height),i.fillStyle="white",i.fill();const t=window.variables.CANVAS;let n=0,a=0,o=0,r=0,w=getScreenResolution(window.variables.WIDTH,window.variables.HEIGHT),s=1;!0===window.variables.FULLSCREEN?(s=window.devicePixelRatio,window.variables.DISPLAY_WIDTH/w.width>=window.variables.DISPLAY_HEIGHT/w.height?(n=window.variables.DISPLAY_HEIGHT/w.height*w.width,a=window.variables.DISPLAY_HEIGHT,o=window.variables.DISPLAY_WIDTH-n,window.variables.MOUSE_X=window.variables.DISPLAY_MOUSE_X,window.variables.MOUSE_Y=window.variables.DISPLAY_MOUSE_Y*(window.variables.HEIGHT/window.variables.DISPLAY_HEIGHT),window.variables.MOUSE_X*=s,window.variables.MOUSE_Y*=s,window.variables.MOUSE_X-=o/2,window.variables.MOUSE_X=window.variables.MOUSE_X*(window.variables.WIDTH/(window.variables.DISPLAY_WIDTH-o))):(n=window.variables.DISPLAY_WIDTH,a=window.variables.DISPLAY_WIDTH/w.width*w.height,r=window.variables.DISPLAY_HEIGHT-a,window.variables.MOUSE_X=window.variables.DISPLAY_MOUSE_X*(window.variables.WIDTH/window.variables.DISPLAY_WIDTH),window.variables.MOUSE_Y=window.variables.DISPLAY_MOUSE_Y,window.variables.MOUSE_X*=s,window.variables.MOUSE_Y*=s,window.variables.MOUSE_Y-=r/2,window.variables.MOUSE_Y=window.variables.MOUSE_Y*(window.variables.HEIGHT/(window.variables.DISPLAY_HEIGHT-r))),t.width=window.innerWidth*s,t.height=window.innerHeight*s):(window.variables.MOUSE_X=window.variables.DISPLAY_MOUSE_X,window.variables.MOUSE_Y=window.variables.DISPLAY_MOUSE_Y,n=window.variables.TARGET_CANVAS.width,a=window.variables.TARGET_CANVAS.height),window.variables.DISPLAY_WIDTH=window.variables.CANVAS.width,window.variables.DISPLAY_HEIGHT=window.variables.CANVAS.height;const l=Object.keys(window.variables.INSTANCES).sort((e,i)=>Number(i)-Number(e));for(let e of l)for(let i in window.variables.INSTANCES[e])for(let t in window.variables.INSTANCES[e][i]){let n=window.variables.INSTANCES[e][i][t];!0===n.alive&&(await n.prepare(),await n.update(),await n.draw())}1==window.variables.DEBUG_MODE&&(i.font="30px Arial",i.textAlign="left",i.fillStyle="green",i.globalAlpha=1,i.fillText("FPS: "+window.variables.FPS,10,33)),t.getContext("2d").clearRect(0,0,t.width,t.height),t.getContext("2d").fillStyle="black",t.getContext("2d").fillRect(0,0,t.width,t.height),t.getContext("2d").fillStyle="white",t.getContext("2d").fillRect(o/2,r/2,n,a),t.getContext("2d").drawImage(window.variables.TARGET_CANVAS,0,0,window.variables.TARGET_CANVAS.width,window.variables.TARGET_CANVAS.height,o/2,r/2,n,a),window.variables.MOUSE_PRESSED=!1}async function start(){commonIOWatch(),mobileIOWatch(),pcIOWatch();let e=0,i=performance.now(),t=0;!async function n(){const a=performance.now();if(t=a-i,t>window.variables.FPS_INTERVAL){i=a-t%window.variables.FPS_INTERVAL;try{await render()}catch(e){alert(e)}e++}window.variables.DELTA_TIME=t/1e3,requestAnimationFrame(n)}(),setInterval(()=>{window.variables.FPS=e,e=0},1e3)}function getScreenResolution(e,i){let t,n,a,o,r,w;for(e<i?(t=e,n=i):(t=i,n=e);t%n!=0;)a=t%n,t=n,n=a;return o=n,r=e/o,w=i/o,{width:r,height:w}}class ArtistElement{constructor(e,i,t){this.alive=!0,this.id=uuid(),window.variables.INSTANCES[e]||(window.variables.INSTANCES[e]={}),window.variables.INSTANCES[e][this.constructor.name]||(window.variables.INSTANCES[e][this.constructor.name]=[]),window.variables.INSTANCES[e][this.constructor.name][this.id]=this,this.x=i,this.y=t,this.xscale=1,this.yscale=1,this.collider_width=0,this.collider_height=0,this.depth=e}async destroyProcess(){!0===this.alive&&(void 0!==this.destroy&&await this.destroy(),this.alive=!1,delete this.x,delete this.y,delete this.id,delete this.collider_width,delete this.collider_height,delete window.variables.INSTANCES[this.depth][this.constructor.name][this.id])}async prepare(){window.variables.MOUSE_PRESSED&&void 0!==this.pressedGlobal&&await this.pressedGlobal(),window.variables.MOUSE_CLICK&&void 0!==this.clickGlobal&&await this.clickGlobal(),0!==this.collider_width&&0!==this.collider_height&&window.variables.MOUSE_X>=this.x-this.collider_width/2&&window.variables.MOUSE_X<=this.x+this.collider_width/2&&window.variables.MOUSE_Y>=this.y-this.collider_height/2&&window.variables.MOUSE_Y<=this.y+this.collider_height/2&&(window.variables.MOUSE_PRESSED&&void 0!==this.pressedMe&&await this.pressedMe(),window.variables.MOUSE_CLICK&&void 0!==this.clickMe&&await this.clickMe())}async update(){}async draw(){}}function instanceDestroy(e){"object"==typeof e&&void 0!==e.destroyProcess&&e.destroyProcess();for(let i in window.variables.INSTANCES)for(let t in window.variables.INSTANCES[i][e]){window.variables.INSTANCES[i][e][t].destroyProcess(),delete window.variables.INSTANCES[i][e][t]}}function instanceCreate(e,i,t,n){void 0===n&&(n=0);let a=new e(n,i,t);return void 0!==a.create&&a.create(),a}function drawSetAlpha(e){window.variables.DRAW_ALPHA=Math.min(1,e)}function drawSetColor(e){window.variables.DRAW_COLOR=e}function drawSetFilter(e){window.variables.DRAW_FILTER=e}function setDrawMode(e){e.restore(),e.scale(1,1),e.font=`${window.variables.DRAW_FONT_SIZE}px ${window.variables.DRAW_FONT}`,e.lineWidth=1,e.globalAlpha=window.variables.DRAW_ALPHA,e.fillStyle=window.variables.DRAW_COLOR,e.strokeStyle=window.variables.DRAW_COLOR,e.filter=window.variables.DRAW_FILTER}class Shape{constructor(e,i){this.ctx=window.variables.TARGET_CANVAS.getContext("2d"),this.x=e,this.y=i}start(){return setDrawMode(this.ctx),this.ctx.beginPath(),this.ctx.moveTo(this.x,this.y),this}line(e,i){return this.ctx.lineTo(e,i),this}quadraticLine(e,i,t,n){return this.ctx.quadraticCurveTo(t,n,e,i),this}bezierLine(e,i,t,n,a,o){return this.ctx.bezierCurveTo(t,n,a,o,e,i),this}fill(){return this.ctx.fill(),this}stroke(){return this.ctx.stroke(),this}move(e,i){return this.ctx.moveTo(e,i),this}}function drawLine(e,i,t,n){const a=window.variables.TARGET_CANVAS.getContext("2d");setDrawMode(a),a.beginPath(),a.moveTo(e,i),a.lineTo(t,n),a.stroke()}function drawLineThick(e,i,t,n,a){const o=window.variables.TARGET_CANVAS.getContext("2d");setDrawMode(o),o.beginPath(),o.moveTo(e,i),o.lineTo(t,n),o.lineWidth=a,o.stroke()}function drawTriangle(e,i,t,n,a,o,r){const w=window.variables.TARGET_CANVAS.getContext("2d");setDrawMode(w),w.beginPath(),w.moveTo(e,i),w.lineTo(t,n),w.lineTo(a,o),r?w.fill():(w.lineTo(e,i),w.stroke())}function drawRectangle(e,i,t,n,a){const o=window.variables.TARGET_CANVAS.getContext("2d");a?(setDrawMode(o),o.fillRect(e,i,t-e,n-i)):(setDrawMode(o),o.beginPath(),o.rect(e,i,t-e,n-i),o.stroke())}function drawCircle(e,i,t,n){const a=window.variables.TARGET_CANVAS.getContext("2d");n?(setDrawMode(a),a.beginPath(),a.arc(e,i,t,0,2*Math.PI),a.fill(),a.stroke()):(setDrawMode(a),a.beginPath(),a.arc(e,i,t,0,2*Math.PI),a.stroke())}function spriteLoad(e,i){let t=new Image;t.src=e,window.variables.SPRITE[i]=t}function spriteGetWidth(e){return window.variables.SPRITE[e].width}function spriteGetHeight(e){return window.variables.SPRITE[e].height}function drawSprite(e,i,t){const n=window.variables.TARGET_CANVAS.getContext("2d");setDrawMode(n),n.drawImage(window.variables.SPRITE[t],e,i,window.variables.SPRITE[t].width,window.variables.SPRITE[t].height)}function drawSpriteExt(e,i,t,n,a,o,r){const w=window.variables.TARGET_CANVAS.getContext("2d");setDrawMode(w),w.translate(e,i),w.rotate(-r*Math.PI/180),w.translate(-e,-i),"center"==n&&(e+=a<0?window.variables.SPRITE[t].width*a/2:-window.variables.SPRITE[t].width*a/2,i+=o<0?window.variables.SPRITE[t].height*o/2:-window.variables.SPRITE[t].height*o/2),w.translate(e-(a<0?window.variables.SPRITE[t].width*a:0),i-(o<0?window.variables.SPRITE[t].height*o:0)),w.scale(a,o),w.drawImage(window.variables.SPRITE[t],0,0,window.variables.SPRITE[t].width,window.variables.SPRITE[t].height),w.setTransform(1,0,0,1,0,0),w.restore()}function drawText(e,i,t){const n=window.variables.TARGET_CANVAS.getContext("2d");setDrawMode(n),n.textAlign="left",n.fillText(t,e,i+15)}function drawTextTransformed(e,i,t,n,a=0){const o=window.variables.TARGET_CANVAS.getContext("2d");setDrawMode(o),o.save(),o.textAlign=n,o.translate(e,i),o.rotate(-a*Math.PI/180),o.translate(-e,-i),o.fillText(t,e,i+window.variables.DRAW_FONT_SIZE/2),o.restore()}function drawSetFont(e,i){window.variables.DRAW_FONT_SIZE=e,window.variables.DRAW_FONT=i}function lengthdirX(e,i){return e*Math.cos(i*(Math.PI/180))}function lengthdirY(e,i){return e*-Math.sin(i*(Math.PI/180))}function pointDistance(e,i,t,n){return Math.sqrt((e-t)*(e-t)+(i-n)*(i-n))}function pointDirection(e,i,t,n){let a=180*Math.atan2(n-i,t-e)/Math.PI;return a<0&&(a=360+a),360-a}function easeInQuad(e){return e*e}function easeOutQuad(e){return-e*(e-2)}function easeInOutQuad(e){let i=2*e;return i<1?.5*i*i:(i-=1,-.5*(i*(i-2)-1))}function easeInCubic(e){return e*e*e}function easeOutCubic(e){let i=e-1;return i*i*i+1}function easeInOutCubic(e){let i=2*e;return i<1?.5*i*i*i:(i-=2,.5*(i*i*i+2))}function easeInQuartic(e){return e*e*e*e}function easeOutQuartic(e){let i=e-1;return-(i*i*i*i-1)}function easeInOutQuartic(e){let i=2*e;return i<1?.5*i*i*i*i:(i-=2,-.5*(i*i*i*i-2))}function easeInQuintic(e){return e*e*e*e*e}function easeOutQuintic(e){let i=e-1;return i*i*i*i*i+1}function easeInOutQuintic(e){let i=2*e;return i<1?.5*i*i*i*i*i:(i-=2,.5*(i*i*i*i*i+2))}function easeInSine(e){return 1-Math.cos(e*Math.PI/2)}function easeOutSine(e){return Math.sin(e*Math.PI/2)}function easeInOutSine(e){return-.5*(Math.cos(e*Math.PI)-1)}function easeInExpo(e){return 0===e?0:Math.pow(2,10*(e-1))}function easeOutExpo(e){return 1===e?1:1-Math.pow(2,-10*e)}function easeInOutExpo(e){if(0===e)return 0;if(1===e)return 1;let i=2*e;return i<1?.5*Math.pow(2,10*(i-1)):.5*(2-Math.pow(2,-10*(i-1)))}function easeInCirc(e){return e<=0?0:e>=1?1:-(Math.sqrt(1-e*e)-1)}function easeOutCirc(e){if(e<=0)return 0;if(e>=1)return 1;let i=e-1;return Math.sqrt(1-i*i)}function easeInOutCirc(e){if(e<=0)return 0;if(e>=1)return 1;let i=2*e;return i<1?-.5*(Math.sqrt(1-i*i)-1):(i-=2,.5*(Math.sqrt(1-i*i)+1))}function easeInElastic(e){if(0===e)return 0;if(1===e)return 1;let i=e-1;return-Math.pow(2,10*i)*Math.sin((i-.075)*(2*Math.PI)/.3)}function easeOutElastic(e){if(0===e)return 0;if(1===e)return 1;return Math.pow(2,-10*e)*Math.sin((e-.075)*(2*Math.PI)/.3)+1}function easeInOutElastic(e){if(0===e)return 0;if(1===e)return 1;let i=2*e-1;return i<0?Math.pow(2,10*i)*Math.sin((i-.075)*(2*Math.PI)/.3)*-.5:Math.pow(2,-10*i)*Math.sin((i-.075)*(2*Math.PI)/.3)*.5+1}function easeInBack(e){let i=1.70158;return e*e*((i+1)*e-i)}function easeOutBack(e){let i=1.70158,t=e-1;return t*t*((i+1)*t+i)+1}function easeInOutBack(e){let i=1.70158,t=2*e;return i*=1.525,t<1?t*t*((i+1)*t-i)*.5:(t-=2,.5*(t*t*((i+1)*t+i)+2))}function easeInBounce(e){return 1-easeOutBounce(1-e)}function easeOutBounce(e){let i=e;return i<1/2.75?7.5625*i*i:i<2/2.75?(i-=1.5/2.75,7.5625*i*i+.75):i<2.5/2.75?(i-=2.25/2.75,7.5625*i*i+.9375):(i-=2.625/2.75,7.5625*i*i+.984375)}function easeInOutBounce(e){return e<.5?.5-.5*easeOutBounce(1-2*e):.5+.5*easeOutBounce(2*e-1)}function randomRange(e,i){return Math.random()*(i-e)+e}function irandomRange(e,i){return e=Math.ceil(e),i=Math.floor(i),Math.round(Math.random()*(i-e))+e}function setDebugMode(e){window.variables.DEBUG_MODE=e}async function request(e,i){return new Promise((t,n)=>{let a=new XMLHttpRequest;a.open("POST",e,!0),a.setRequestHeader("Content-type","application/json;charset=UTF-8"),a.setRequestHeader("Connection","close"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&(1==window.variables.debug&&console.log("[HTTP RECV]",a.responseText),t(JSON.parse(a.responseText)))},1==window.variables.debug&&console.log("[HTTP SEND]",JSON.stringify(i)),a.send(JSON.stringify(i))})}function setFullScreen(e){if(window.variables.CANVAS.style["touch-action"]="none",window.variables.CANVAS.style.cursor="inherit",!1===e)return window.variables.CANVAS.width=window.variables.WIDTH,window.variables.CANVAS.height=window.variables.HEIGHT,window.variables.CANVAS.style.width=window.variables.CANVAS.width+"px",void(window.variables.CANVAS.style.height=window.variables.CANVAS.height+"px");window.variables.CANVAS.style.width="100%",window.variables.CANVAS.style.height="100%",window.variables.CANVAS.style["touch-action"]="none",window.variables.CANVAS.style.cursor="inherit",window.variables.FULLSCREEN=!0,window.variables.CANVAS.width=2*window.innerWidth,window.variables.CANVAS.height=2*window.innerHeight,window.variables.DISPLAY_WIDTH=window.variables.CANVAS.width,window.variables.DISPLAY_HEIGHT=window.variables.CANVAS.height}function commonIOWatch(){window.onkeydown=onKeyboardDown,window.onkeyup=onKeyboardUp}function onKeyboardDown(e){window.variables.KEYBOARD_CHECK=!0,window.variables.KEYBOARD_CODE=e.which||e.keyCode}function onKeyboardUp(e){window.variables.KEYBOARD_CHECK=!1,window.variables.KEYBOARD_CODE}function mobileIOWatch(){window.variables.CANVAS.addEventListener("touchstart",onTouchStart),window.variables.CANVAS.addEventListener("touchend",onTouchEnd),window.variables.CANVAS.addEventListener("touchmove",onTouchMove)}function onTouchStart(e){const i=e.touches[0];window.variables.DISPLAY_MOUSE_X=i.clientX,window.variables.DISPLAY_MOUSE_Y=i.clientY,window.variables.MOUSE_PRESSED=!0,window.variables.MOUSE_CLICK=!0}function onTouchEnd(){window.variables.MOUSE_CLICK=!1}function onTouchMove(e){const i=e.touches[0];window.variables.DISPLAY_MOUSE_X=i.clientX,window.variables.DISPLAY_MOUSE_Y=i.clientY}function pcIOWatch(){window.addEventListener("mousemove",onMouseUpdate),window.addEventListener("mouseenter",onMouseUpdate),window.onmousedown=onMouseDown,window.onmouseup=onMouseUp}function getMousePosition(e,i){if(!1==!!e)throw"getMousePos - canvas is not exists";const t=e.getBoundingClientRect();return{x:i.clientX-t.left,y:i.clientY-t.top}}function onMouseUpdate(e){const i=getMousePosition(window.variables.CANVAS,e);window.variables.DISPLAY_MOUSE_X=i.x,window.variables.DISPLAY_MOUSE_Y=i.y}function onMouseDown(e){window.variables.MOUSE_X>=0&&window.variables.MOUSE_Y>=0&&window.variables.MOUSE_X<=window.variables.DISPLAY_WIDTH&&window.variables.MOUSE_Y<=window.variables.DISPLAY_HEIGHT&&(window.variables.MOUSE_PRESSED=!0,window.variables.MOUSE_CLICK=!0)}function onMouseUp(e){window.variables.MOUSE_X>=0&&window.variables.MOUSE_Y>=0&&window.variables.MOUSE_X<=window.variables.DISPLAY_WIDTH&&window.variables.MOUSE_Y<=window.variables.DISPLAY_HEIGHT&&(window.variables.MOUSE_CLICK=!1)}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const i=16*Math.random()|0;return("x"==e?i:3&i|8).toString(16)})}window.variables={CANVAS:void 0,DEBUG_MODE:!1,FPS:0,FPS_INTERVAL:100/6,FULLSCREEN:!1,DELTA_TIME:0,TARGET_CANVAS:document.createElement("canvas"),WIDTH:0,HEIGHT:0,DISPLAY_WIDTH:0,DISPLAY_HEIGHT:0,INSTANCES:{},SPRITE:{},KEYBOARD_CHECK:!1,KEYBOARD_CODE:-1,MOUSE_PRESSED:!1,MOUSE_CLICK:!1,MOUSE_X:0,MOUSE_Y:0,DISPLAY_MOUSE_X:0,DISPLAY_MOUSE_Y:0,DRAW_COLOR:"black",DRAW_ALPHA:1,DRAW_FONT:"Arial",DRAW_FONT_SIZE:15,DRAW_FILTER:"none"};